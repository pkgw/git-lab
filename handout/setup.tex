% Basic packages
\usepackage{dblfloatfix, fixltx2e, graphicx}
\usepackage[breaklinks, colorlinks, urlcolor=blue, citecolor=blue, linkcolor=blue]{hyperref}
\usepackage{tabularx} % for \prompt
\usepackage[table]{xcolor} % for \prompt
\usepackage{changepage} % for indented paragraphs


% Skips between pars rather than indents at their beginnings; works better for
% this kind of document, I think:
\usepackage[parfill]{parskip}


% Page setup
\usepackage[letterpaper, includehead, margin=1in, top=0.5in, headheight=15pt]{geometry}
\usepackage{fancyhdr}
\pagestyle{fancyplain}
\fancyhf{}
\fancyhead[LE,RO]{\thepage}
\fancyhead[LO,RE]{\textsf{\leftmark}}


% Fonts. Note that EB Garamond has no bold, alas!
\usepackage{fontspec}
\newfontfeature{Microtype}{protrusion=default; expansion=default;}

\setmainfont[
  Microtype,
  Ligatures = Common,
  ItalicFont = EBGaramond12-Italic.otf
]{EBGaramond12-Regular.otf}

\setmonofont[
  Scale = MatchLowercase,
  Ligatures = Common, % needed for vertical quotes, etc.
  BoldFont = SourceCodePro-Bold.otf,
  ItalicFont = SourceCodePro-It.otf,
  BoldItalicFont = SourceCodePro-BoldIt.otf,
]{SourceCodePro-Regular.otf}


% Sectioning
\usepackage{titlesec}
\titleformat{\section} {\sffamily\Large\bfseries}{Topic \thesection:}{1ex}{}
\titleformat{\subsection} {\sffamily\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection} {\sffamily\normalsize\bfseries}{\thesubsubsection}{1em}{}
\titlespacing*{\section} {0pt}{2.5ex plus 1ex minus 0.2ex}{1ex plus 0.2ex}
\titlespacing*{\subsection} {0pt}{2ex plus 0.8ex minus 0.2ex}{1ex plus 0.1ex}
\titlespacing*{\subsubsection} {0pt}{3.25ex plus 1ex minus 0.2ex}{1.5ex plus 0.2ex}

\renewcommand\sectionmark[1]{\markboth{#1}{}} % needed for good headers.


% Title formatting
\usepackage{titling}
\pretitle{\begin{center}\Huge}
\posttitle{\end{center}}


% Lists
%% \usepackage{enumitem}
%% \setitemize{noitemsep,topsep=6pt,parsep=0pt,partopsep=0pt,leftmargin=*}
%% \setenumerate{noitemsep,topsep=6pt,parsep=0pt,partopsep=0pt,leftmargin=*}


% Miscellaneous small macros.

\let\b=\textbf
\let\i=\textit
\let\s=\textsf
\let\t=\texttt

\newcommand\cmd[1]{\s{git~#1}}
\newcommand\demohead{c91b4e} % NOTE! sync with bloomdemo.
\newcommand\git{\s{git}}
\newcommand\ie{\i{i.e.}}


\input gitversion % definition generated during build process


% The question-to-answer environment. Derived from `leftbar` environment of
% `framed` package. We just make the rule thinner.

\usepackage{framed}

\newcommand\fillme[2]{%
  \bigskip%
  \begingroup%
  \def\FrameCommand{\vrule width 1pt \hspace{10pt}}%
  \MakeFramed {\advance\hsize-\width \FrameRestore}%
  \i{#2}\rule[-#1]{0in}{#1}%
  \endMakeFramed%
}


% The commands-to-type environment. Wow. Much magic.

\newenvironment{typeme}{%
  \tabularx{6.5in}{>{\columncolor{lightgray}\ttfamily\$ }X>{\sffamily}l}
}{%
  \endtabularx%
}

\newcommand\typeone[2]{%
  \begin{typeme}%
  #1 & #2%
  \end{typeme}%
}

\newcommand\fillinparam[1]{\textsf{\textbf{\{#1\}}}}
\let\p=\fillinparam


% Boxes around sample characters in the Introduction.
\setlength{\fboxsep}{1pt}
